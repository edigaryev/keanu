container:
  image: golang:latest

env:
  GOPROXY: https://proxy.golang.org

lint_task:
  container:
    image: golangci/golangci-lint:latest
  lint_script:
    - golangci-lint run -v -p bugs,complexity,format,performance,style,unused -D goimports,wsl,gochecknoglobals,funlen

test_task:
  depends_on:
    - lint
  env:
    CODECOV_TOKEN: "cdb42aa7-f7b2-4469-9452-bee9a71d4d47"
  test_script:
    - go test -v -coverprofile=coverage.txt -covermode=atomic ./...
    - bash <(curl -s https://codecov.io/bash)

build_task:
  depends_on:
    - test
  build_script:
    - go build
